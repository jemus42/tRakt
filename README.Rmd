---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  message = FALSE, warning = FALSE, error = FALSE
)
```

# tRakt

[![Travis build status](https://travis-ci.org/jemus42/tRakt.svg?branch=master)](https://travis-ci.org/jemus42/tRakt)
[![Coverage status](https://codecov.io/gh/jemus42/tRakt/branch/master/graph/badge.svg)](https://codecov.io/github/jemus42/tRakt?branch=master)
[![CRAN status](https://www.r-pkg.org/badges/version/tRakt)](https://cran.r-project.org/package=tRakt)

This is `tRakt` version ``r desc::desc_get("Version")``.  
It contains functions to retrieve data from [trakt.tv](http://trakt.tv/), a site similiar to [IMDb](http://imdb.com) with a broader focus including TV shows and more social features â€“ and, most importantly, a publicly available API.

It's an [R package](http://r-project.org) primarily used by (i.e. built for) [this webapp](http://trakt.jemu.name), but you can fiddle around with it if you like.  
Please note that while this package *basically* is an API-client, it is a little more opinionated and might deliver results that don not exactly match the data delivered by the API. The primary motivation for this package is to retrieve data that is easily processable for data analysis and display, which is why it tries hard to coerce most data into tabular form instead of using, for example, nested lists.

## Installation

Get it from GitHub:

```r
if (!require("remotes")) install.packages("remotes")
remotes::install_github("jemus42/tRakt")
library("tRakt")
```

## Basic usage

```{r}
library(dplyr)
library(tRakt)

# Search for show, get basic info
show_info <- trakt.search("Utopia", type = "show")
glimpse(show_info)

# Get season information for the show
show_seasons <- trakt.seasons.summary(show_info$trakt)

knitr::kable(show_seasons)

# Get episode data
show_episodes <- trakt.seasons.season(show_info$trakt, 
                                      seasons = c(1, 2), extended = "full")

show_episodes %>%
  select(season, episode_number, title, rating, votes, first_aired) %>%
  knitr::kable()
```


## Setting credentials

The APIv2 requires at least a `client id` for the API calls.  
Calling `get_trakt_credentials()` will set everything up for you, but you either have to
manually plug your values in (see `?get_trakt_credentials()`), or have the values supplied via enviroment variables in your `.Renviron` like this:

```sh
# tRakt
trakt_username=jemus42
trakt_client_id=12fc1de7[...]3d629afdf2
```

* `trakt_username` Optional. For functions that pull a user's watched shows or stats (`trakt.user.*`)
* `trakt_client_id` Required. It's used in the HTTP headers for the API calls, which is kind of a biggie.

To get your credentials, [you have to have an (approved) app over at trakt.tv](http://trakt.tv/oauth/applications).  
Don't worry, it's really easy to set up. Even I did it.

### Use my app's client.id as a fallback

As a convenience for you, and also to make automated testing a little easier, `get_trakt_credentials()` automatically sets my `client.id` as a fallback, so you theoretically never need to supply your own credentials. However, if you want to actually use this package for some project, I do not recommend relying on my credentials. That would make me a sad panda.

# Code of Conduct

Please note that the **tRakt** project is released with a [Contributor Code of Conduct](.github/CODE_OF_CONDUCT.md). By contributing to this project, you agree to abide by its terms.
